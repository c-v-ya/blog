{"componentChunkName":"component---src-templates-post-template-js","path":"/2019-10-09-avoid-multiple-elif","result":{"data":{"markdownRemark":{"frontmatter":{"date":"October 09, 2019","title":"Avoid multiple ElIf situation","path":"/2019-10-09-avoid-multiple-elif","description":"Reducing code smelling with a help from first class citizens","tags":"python, if statement, dictionary, beginners"},"html":"<h2>Reducing code smelling with a help from first class citizens</h2>\n<p><em>Photo by</em> <a href=\"https://unsplash.com/@picoftasty?utm_source=unsplash&#x26;utm_medium=referral&#x26;utm_content=creditCopyText\"><em>Mae Mu</em></a> <em>on</em> <a href=\"https://unsplash.com/s/photos/pancakes?utm_source=unsplash&#x26;utm_medium=referral&#x26;utm_content=creditCopyText\"><em>Unsplash</em></a></p>\n<p>Recently I've encountered a situation where <code class=\"language-text\">elif&#39;s</code> stacked on top of each other like pancakes.\nFor example, we are parsing different file formats. Our parsers are ready and we just need a higher level interface.</p>\n\n        <deckgo-highlight-code language=\"python\"  theme=\"monokai\" >\n          <code slot=\"code\">if file_format == &#39;xml&#39;:\n    parse_xml(file_name)\nelif file_format == &#39;csv&#39;:\n    parse_csv(file_name)\nelif file_format == &#39;json&#39;:\n    parse_json(file_name)\nelse:\n    parse_txt(file_name)</code>\n        </deckgo-highlight-code>\n      \n<p>At first there were just <code class=\"language-text\">if</code> and <code class=\"language-text\">else</code>. Then things started to add up and I realized\nthat multiple <code class=\"language-text\">elif&#39;s</code> was just a smelling piece of code.</p>\n<p>To deal with that we can leverage a python concept that functions are first class citizens.\nMeaning we can return them or use them as a dictionary values.\nSo we need to map our file formats with corresponding parsing functions:</p>\n\n        <deckgo-highlight-code language=\"python\"  theme=\"monokai\" >\n          <code slot=\"code\">parsers = {\n &#39;xml&#39;: parse_xml,\n &#39;csv&#39;: parse_csv,\n &#39;json&#39;: parse_json,\n}</code>\n        </deckgo-highlight-code>\n      \n<p>Notice that I did not include our default txt parser. It's like we rewrote\n<code class=\"language-text\">if</code> and <code class=\"language-text\">elif&#39;s</code> of our previous code. Now we need a function to return a parser for a given file format:</p>\n\n        <deckgo-highlight-code language=\"python\"  theme=\"monokai\" >\n          <code slot=\"code\">def get_parser(file_format):\n    return parsers.get(file_format, parse_txt)</code>\n        </deckgo-highlight-code>\n      \n<p>This will return a parser function from our <code class=\"language-text\">parsers</code> dictionary for a given file format.\nOr, if <code class=\"language-text\">file_format</code> is not a key of that dictionary, default <code class=\"language-text\">parse_txt</code>.\nAs an analogy before, it's like we rewrote the last <code class=\"language-text\">else</code> statement.</p>\n<p>To use that we need to call <code class=\"language-text\">get_parser</code> function and we can also immediately execute it:</p>\n\n        <deckgo-highlight-code language=\"python\"  theme=\"monokai\" >\n          <code slot=\"code\">get_parser(&#39;csv&#39;)(file_name)</code>\n        </deckgo-highlight-code>\n      \n<p>But if you want to be more transparent, you can expand this to multiple lines:</p>\n\n        <deckgo-highlight-code language=\"python\"  theme=\"monokai\" >\n          <code slot=\"code\">parser = get_parser(&#39;csv&#39;)\nparser(file_name)</code>\n        </deckgo-highlight-code>\n      \n<p>I think this code looks better than at the beginning of the article, although\nmight not be obvious for everyone, so don't forget to place some comments :)</p>\n<p>And I want to believe that it works a little faster because we're just getting a value\nfrom a dictionary instead of checking every single <code class=\"language-text\">if</code> case.</p>","timeToRead":2},"file":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB41K0wGH/xAAYEAEAAwEAAAAAAAAAAAAAAAABAAIxEP/aAAgBAQABBQKOSu2R5//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/AYf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAEBEiMf/aAAgBAQAGPwIlWx//xAAaEAACAgMAAAAAAAAAAAAAAAAAARExEHGR/9oACAEBAAE/IUJqwisgVLXSD//aAAwDAQACAAMAAAAQXz//xAAWEQADAAAAAAAAAAAAAAAAAAABEEH/2gAIAQMBAT8QFL//xAAWEQADAAAAAAAAAAAAAAAAAAAQEUH/2gAIAQIBAT8QcH//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMUFx/9oACAEBAAE/EMkRfg19Y9hy0mtdZlhrjZlp/9k=","aspectRatio":1.25,"src":"/blog/static/580162bea28c303dbfaa625b4a175396/68386/mae-mu-ecUVGNZA1TM-unsplash.jpg","srcSet":"/blog/static/580162bea28c303dbfaa625b4a175396/474e4/mae-mu-ecUVGNZA1TM-unsplash.jpg 320w,\n/blog/static/580162bea28c303dbfaa625b4a175396/3bf7d/mae-mu-ecUVGNZA1TM-unsplash.jpg 640w,\n/blog/static/580162bea28c303dbfaa625b4a175396/68386/mae-mu-ecUVGNZA1TM-unsplash.jpg 1280w,\n/blog/static/580162bea28c303dbfaa625b4a175396/097fa/mae-mu-ecUVGNZA1TM-unsplash.jpg 1920w,\n/blog/static/580162bea28c303dbfaa625b4a175396/2e889/mae-mu-ecUVGNZA1TM-unsplash.jpg 2560w,\n/blog/static/580162bea28c303dbfaa625b4a175396/f1858/mae-mu-ecUVGNZA1TM-unsplash.jpg 3454w","sizes":"(max-width: 1280px) 100vw, 1280px"}}}},"pageContext":{"imagePath":"mae-mu-ecUVGNZA1TM-unsplash.jpg","prev":{"frontmatter":{"path":"/2019-11-04-why-context-manager-is-useful","title":"Why Context Manager is useful","date":"November 04, 2019","author":"Constantine Yarushkin","description":"How not to think about consequences when acquiring resources","image":"efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg","tags":"python, sql, context manager, beginners"}},"next":{"frontmatter":{"path":"/2019-09-30-python-dict-values","title":"Getting values from a Python dictionary","date":"September 30, 2019","author":"Constantine Yarushkin","description":"How to get a value from a Python dictionary and not get punched by a KeyError","image":"sharon-mccutcheon-s4RaGIo2eYI-unsplash.jpg","tags":"python, dictionary, beginners"}}}}}