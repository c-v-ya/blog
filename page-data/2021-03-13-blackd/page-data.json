{"componentChunkName":"component---src-templates-post-template-js","path":"/2021-03-13-blackd","result":{"data":{"markdownRemark":{"frontmatter":{"date":"March 13, 2021","title":"Black in Docker","path":"/2021-03-13-blackd","description":"Fromatting Python code remotely with PyCharm","tags":"docker, black"},"html":"<p><em>Photo by</em> <a href=\"https://unsplash.com/@jxk?utm_source=unsplash&#x26;utm_medium=referral&#x26;utm_content=creditCopyText\"><em>Jan KopÅ™iva</em></a> <em>on</em> <a href=\"https://unsplash.com/?utm_source=unsplash&#x26;utm_medium=referral&#x26;utm_content=creditCopyText\"><em>Unsplash</em></a></p>\n<p>I'm sure you've heard about <a href=\"https://black.readthedocs.io/en/stable\">Black</a>, a formatter for Python. It's opinionated, but really good. One thing I disagree with - is double quotes everywhere. I prefer single. But that is disable-able.</p>\n<p>So, what's Docker doing here? Well, you can run Black as a service. Meaning you can skip installation on a local machine and deploy straight with containers.</p>\n<h1>Dockerfile</h1>\n<p>I've published a final <a href=\"https://hub.docker.com/r/ceeveeya/blackd\">image</a> so you can just pull that from dockerhub. Or build it yourself. Here we go with a multi-stage build to make our container slim.</p>\n\n        <deckgo-highlight-code   theme=\"monokai\" >\n          <code slot=\"code\">FROM python:3.9-alpine as builder\nRUN set -eux \\\n        &amp;&amp; apk add --no-cache \\\n                gcc \\\n                musl-dev \\\n    &amp;&amp; pip install --upgrade pip black[d]\n\nFROM python:alpine\nCOPY --from=builder /usr/local/lib/python3.9/site-packages/ /usr/local/lib/python3.9/site-packages/\nCOPY --from=builder /usr/local/bin/blackd /usr/local/bin/blackd\nEXPOSE 45484\nENTRYPOINT [&quot;blackd&quot;, &quot;--bind-host&quot;, &quot;0.0.0.0&quot;, &quot;--bind-port&quot;, &quot;45484&quot;]</code>\n        </deckgo-highlight-code>\n      \n<p>First we build a <code class=\"language-text\">builder</code> image, installing dependencies and Black itself. Then we just copy what we need from <code class=\"language-text\">builder</code> to the final image. That way we'll have around 70Mb in size.</p>\n<p>Now you can build with:</p>\n\n        <deckgo-highlight-code   theme=\"monokai\" >\n          <code slot=\"code\">docker build . -t blackd:latest</code>\n        </deckgo-highlight-code>\n      \n<h1>Container</h1>\n<p>Let's go to \"Containers\" side-menu in <a href=\"https://www.portainer.io\">Portainer</a> and smash the \"Add container\" button. Set:</p>\n<ul>\n<li>name: blackd</li>\n<li>image: blackd:latest OR ceeveeya/blackd:latest</li>\n<li>publish port: 45484:45484</li>\n</ul>\n<p>A handy screenshot:\n<img src=\"https://raw.githubusercontent.com/c-v-ya/con-con/master/screenshots/Blackd.png\" alt=\"Blackd create container\" title=\"Blackd create container\"></p>\n<p>And press \"Deploy\".</p>\n<h1>Usage</h1>\n<p>Now when we have working Black service all is left - to use that.</p>\n<h2>Pycharm</h2>\n<p>Add <a href=\"https://plugins.jetbrains.com/plugin/14321-blackconnect\">BlackConnect</a> plugin and set config as on the screenshot below.</p>\n<p><img src=\"https://raw.githubusercontent.com/c-v-ya/con-con/master/screenshots/BlackConnect.png\" alt=\"BlackConnect config\" title=\"BlackConnect config\"></p>\n<h2>VSCode</h2>\n<p>Unfortunately, I couldn't find a similar extension for this IDE. But I'm not using VSCode for python development so.. Â¯\\_(ãƒ„)_/Â¯ Let's hope somebody will make something like BlackConnect one day ðŸ˜…</p>\n<hr>\n<p>Now your code should be formatted every time you save it!</p>","timeToRead":2},"file":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHIrgQC/8QAGRAAAQUAAAAAAAAAAAAAAAAAAAIQETJC/9oACAEBAAEFAk20S/8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAwADAQAAAAAAAAAAAAAAAAERECExUf/aAAgBAQABPyGa8hA+iZcLu4//2gAMAwEAAgADAAAAELA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAwEBAQEAAAAAAAAAAAAAAAERIVExwf/aAAgBAQABPxCuC2+CT2somp0c1pC30o1p/9k=","aspectRatio":1.5023474178403755,"src":"/blog/static/fdde985747cf65bac93e34717c76b8e2/68386/jan-kopriva-Fkt-gbaYJMs-unsplash.jpg","srcSet":"/blog/static/fdde985747cf65bac93e34717c76b8e2/474e4/jan-kopriva-Fkt-gbaYJMs-unsplash.jpg 320w,\n/blog/static/fdde985747cf65bac93e34717c76b8e2/3bf7d/jan-kopriva-Fkt-gbaYJMs-unsplash.jpg 640w,\n/blog/static/fdde985747cf65bac93e34717c76b8e2/68386/jan-kopriva-Fkt-gbaYJMs-unsplash.jpg 1280w,\n/blog/static/fdde985747cf65bac93e34717c76b8e2/097fa/jan-kopriva-Fkt-gbaYJMs-unsplash.jpg 1920w","sizes":"(max-width: 1280px) 100vw, 1280px"}}}},"pageContext":{"imagePath":"jan-kopriva-Fkt-gbaYJMs-unsplash.jpg","prev":{"frontmatter":{"path":"/2021-03-19-clean-up-docker","title":"Cleaning Up Space after Docker","date":"March 19, 2021","author":"Constantine Yarushkin","description":"Easily free up gigabytes of space!","image":"wil-stewart-rYWz3Q88P8g-unsplash.jpg","tags":"docker, logs"}},"next":{"frontmatter":{"path":"/2021-03-04-kafka","title":"Setting Up Kafka in Docker","date":"March 04, 2021","author":"Constantine Yarushkin","description":"It's easier than it looks","image":"anne-nygard-RaUUoAnVgcA-unsplash.jpg","tags":"docker, kafka"}}}}}