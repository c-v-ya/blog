{"componentChunkName":"component---src-templates-post-template-js","path":"/2019-11-04-why-context-manager-is-useful","result":{"data":{"markdownRemark":{"frontmatter":{"date":"November 04, 2019","title":"Why Context Manager is useful","path":"/2019-11-04-why-context-manager-is-useful","description":"How not to think about consequences when acquiring resources","tags":"python, sql, context manager, beginners"},"html":"<h2>How not to think about consequences when acquiring resources</h2>\n<p><em>Photo by</em> <a href=\"https://unsplash.com/@efeyagizs?utm_source=unsplash&#x26;utm_medium=referral&#x26;utm_content=creditCopyText\"><em>Efe Yağız Soysal</em></a> <em>on</em> <a href=\"https://unsplash.com/@efeyagizs?utm_source=unsplash&#x26;utm_medium=referral&#x26;utm_content=creditCopyText\"><em>Unsplash</em></a></p>\n<p>Imagine this: you automated some actions on a webpage via Selenium\nand it works fine. But there are times when it might crash.\nYou don't want to <code class=\"language-text\">if</code> every single step that can go wrong.</p>\n<p>Very graceful solution would be a Context Manager. You've already\nused it when opened files. That <code class=\"language-text\">with open</code> is the Context Manager.\nIt tries to acquire a resource and closes it if something goes wrong,\nreleasing the given resource.</p>\n<p>Let's get back to our example with Selenium. When it crashes browser\nwindow doesn't close, leaving it hang until you close it. Would it be\nawesome if that window would close if the program crashed?</p>\n<p>There are couple ways to implement Context Manager in Python.\nFirst is the class definition:</p>\n\n        <deckgo-highlight-code language=\"python\"  theme=\"monokai\" >\n          <code slot=\"code\">from settings import web_driver\n\nclass ContextDriver:\n    def __init__(self):\n        self.driver = web_driver\n\n    def __enter__(self):\n        return self.driver\n\n    def __exit__(self):\n        self.driver.close()</code>\n        </deckgo-highlight-code>\n      \n<p>The driver in the settings is a simple Firefox selenium web driver:</p>\n\n        <deckgo-highlight-code language=\"python\"  theme=\"monokai\" >\n          <code slot=\"code\">from selenium import webdriver\n\nweb_driver = webdriver.Firefox()</code>\n        </deckgo-highlight-code>\n      \n<p>And that's it! Now you can write <code class=\"language-text\">with ContextDriver() as driver</code>\nand use that <code class=\"language-text\">driver</code> to perform automation. So if anything goes wrong\nit will close the browser window.</p>\n<p>Now, writing a class for such an easy task is redundant, in my opinion.\nLuckily, in Python we have a useful decorator:</p>\n\n        <deckgo-highlight-code language=\"python\"  theme=\"monokai\" >\n          <code slot=\"code\">from contextlib import contextmanager\nfrom settings import web_driver\n\n@contextmanager\ndef ContextDriver():\n    try:\n        yield web_driver\n    finally:\n        web_driver.close()</code>\n        </deckgo-highlight-code>\n      \n<p>Neat, isn't it? In fact, I first wrote this Context Manager via decorator\nwhen encountered this problem at work. And spent quiet some time rewriting\nit as a class for this article. This doesn't mean you should know only\nhow to do it with decorator, even though it's much easier. There are times\nwhen you will need a class and in one of the later articles I'll show that.</p>\n<p>And there is one more way to define a Context Manager. Just import closing\nand use <code class=\"language-text\">with closing(driver) as…</code> This works with everything that has\na <code class=\"language-text\">close()</code> method. But I'm not a big fan of this.</p>\n<p>So now you know why and how to use a Context Manager! But just knowing\nis not enough. Try it in your next project. Or even in your current one!\nThat way you will be confident that you can implement this wherever\nit's suitable. Also, this is one of the topics technical interviewers\nlike to ask about.</p>","timeToRead":2},"file":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECA//EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHFRErLKP/EABkQAAIDAQAAAAAAAAAAAAAAAAECABESIf/aAAgBAQABBQJF4KtmWzkEqJhZ/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAwEBAAAAAAAAAAAAAAAAACExEKH/2gAIAQEABj8CuzokQ//EABoQAAMBAQEBAAAAAAAAAAAAAAABESFxMWH/2gAIAQEAAT8hyV30aeqQ853gyccQ4dfaXP8A/9oADAMBAAIAAwAAABCPH//EABYRAQEBAAAAAAAAAAAAAAAAAAARIf/aAAgBAwEBPxDEf//EABYRAQEBAAAAAAAAAAAAAAAAAAARIf/aAAgBAgEBPxDVf//EABoQAQADAQEBAAAAAAAAAAAAAAEAESExQVH/2gAIAQEAAT8Q09VvH3JZ0A7VA8lfjrtKlrJe2uRxuBi4HpKBjn3s/9k=","aspectRatio":1.5311004784688995,"src":"/blog/static/8c1c6759e4822546834b518534ea901b/68386/efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg","srcSet":"/blog/static/8c1c6759e4822546834b518534ea901b/474e4/efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg 320w,\n/blog/static/8c1c6759e4822546834b518534ea901b/3bf7d/efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg 640w,\n/blog/static/8c1c6759e4822546834b518534ea901b/68386/efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg 1280w,\n/blog/static/8c1c6759e4822546834b518534ea901b/097fa/efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg 1920w,\n/blog/static/8c1c6759e4822546834b518534ea901b/2e889/efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg 2560w,\n/blog/static/8c1c6759e4822546834b518534ea901b/a98af/efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg 4096w","sizes":"(max-width: 1280px) 100vw, 1280px"}}}},"pageContext":{"imagePath":"efe-yagiz-soysal-XcJDpwrbMyg-unsplash.jpg","prev":{"frontmatter":{"path":"/2020-01-08-sql-cursor-via-context-manager","title":"SQL Cursor via Context Manager","date":"January 08, 2020","author":"Constantine Yarushkin","description":"Automatically closing database connection with Context Manager","image":"taylor-vick-M5tzZtFCOfs-unsplash.jpg","tags":"python, sql, context manager"}},"next":{"frontmatter":{"path":"/2019-10-09-avoid-multiple-elif","title":"Avoid multiple ElIf situation","date":"October 09, 2019","author":"Constantine Yarushkin","description":"Reducing code smelling with a help from first class citizens","image":"mae-mu-ecUVGNZA1TM-unsplash.jpg","tags":"python, if statement, dictionary, beginners"}}}}}